<!doctype html>
<meta charset="utf-8">
<title>chao.js</title>
<head>
	<style type="text/css">
		body {
			margin: 0;
			background-color: #202020
		}
	</style>
</head>
<body>
	<center>
		<canvas id="canvas_id" width="640" height="480"></canvas>

		<script src="../chao.js"></script>
		<script>

			chao.init(640, 480, chao.SCALING_MODE_NONE, "canvas_id");
			// chao.setImagesSmoothing(false);
			chao.loadImage("sticker", "sticker.png");

			function StateGame(){

				this.img1;
				this.img2;
				this.img3;
				this.bounceTimer = 0.0;

				this.create = function(){
					chao.backgroundColor = "black";
					this.img1 = chao.helpers.createSprite("Image 1", "sticker", 0, 0);
					this.add(this.img1.entity);

					this.img1.entity.alignToParent();

					this.img2 = chao.helpers.createSprite("Image 2", "sticker", 100, 100);
					// this.img2.entity.scaleX = 1.5;
					// this.img2.entity.scaleY = 1.5;
					this.img1.entity.add(this.img2.entity);

					this.img3 = chao.helpers.createSprite("Image 2", "sticker", 100, 100);
					this.img3.entity.scaleX = 0.5;
					this.img3.entity.scaleY = 0.5;
					this.img2.entity.add(this.img3.entity);
					this.img3.entity.alignToParent();
				}

				this.update = function(){
					this.bounceTimer += chao.getTimeDelta() * 2.0;

					this.img3.entity.scaleX = 0.5 + Math.sin(this.bounceTimer) * 0.25;
					this.img3.entity.scaleY = 0.5 + Math.cos(this.bounceTimer) * 0.25;

					// this.img2.entity.scaleX = 0.5 + Math.sin(this.bounceTimer) * 0.25;
					// this.img2.entity.scaleY = 0.5 + Math.cos(this.bounceTimer) * 0.25;

					// this.img1.entity.x = 100 + Math.sin(this.bounceTimer*0.9) * 50;
					// this.img1.entity.y = 100 + Math.cos(this.bounceTimer*0.9) * 50;

					// this.img1.entity.rotation += chao.getTimeDelta() * 50.0;
					// this.img2.entity.rotation += chao.getTimeDelta() * 50.0;
					this.img3.entity.rotation += chao.getTimeDelta() * 50.0;
					// this.img2.entity.rotation = 45;

					if (chao.justPressed[chao.KEY_SPACE]){
						var entity = this.img3.entity;
						// chao.log(entity.getTransformMatrix().x);
						// chao.log(entity.getTransformMatrix().y);
						// chao.log(entity.getTransformMatrix().origin);
						chao.log(entity.rotation);
						// chao.log(entity.screenRotation);
					}

					if(chao.justPressed[chao.KEY_L]){
						chao.logHierarchy(this.rootEntity);
					}

					var rotationSpeed = 100.0;
					if(chao.pressed[chao.KEY_LEFT]){
						this.img1.entity.rotation -= chao.getTimeDelta() * rotationSpeed;
					}
					if(chao.pressed[chao.KEY_RIGHT]){
						this.img1.entity.rotation += chao.getTimeDelta() * rotationSpeed;
					}
					if(chao.pressed[chao.KEY_X]){
						this.img1.entity.rotation = 0;
					}
					
				}
			}
			
			chao.switchState(new StateGame());



		</script>
</body>